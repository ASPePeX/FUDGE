var Fudge;
(function (Fudge) {
    let CONTEXTMENU;
    (function (CONTEXTMENU) {
        // SKETCH = ViewSketch,
        CONTEXTMENU[CONTEXTMENU["ADD_NODE"] = 0] = "ADD_NODE";
        CONTEXTMENU[CONTEXTMENU["ACTIVATE_NODE"] = 1] = "ACTIVATE_NODE";
        CONTEXTMENU[CONTEXTMENU["DELETE_NODE"] = 2] = "DELETE_NODE";
        CONTEXTMENU[CONTEXTMENU["ADD_COMPONENT"] = 3] = "ADD_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["DELETE_COMPONENT"] = 4] = "DELETE_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["ADD_COMPONENT_SCRIPT"] = 5] = "ADD_COMPONENT_SCRIPT";
        CONTEXTMENU[CONTEXTMENU["EDIT"] = 6] = "EDIT";
        CONTEXTMENU[CONTEXTMENU["CREATE_FOLDER"] = 7] = "CREATE_FOLDER";
        CONTEXTMENU[CONTEXTMENU["CREATE_MESH"] = 8] = "CREATE_MESH";
        CONTEXTMENU[CONTEXTMENU["CREATE_MATERIAL"] = 9] = "CREATE_MATERIAL";
        CONTEXTMENU[CONTEXTMENU["CREATE_GRAPH"] = 10] = "CREATE_GRAPH";
        CONTEXTMENU[CONTEXTMENU["CREATE_ANIMATION"] = 11] = "CREATE_ANIMATION";
        CONTEXTMENU[CONTEXTMENU["CREATE_PARTICLE_EFFECT"] = 12] = "CREATE_PARTICLE_EFFECT";
        CONTEXTMENU[CONTEXTMENU["SYNC_INSTANCES"] = 13] = "SYNC_INSTANCES";
        CONTEXTMENU[CONTEXTMENU["REMOVE_COMPONENT"] = 14] = "REMOVE_COMPONENT";
        CONTEXTMENU[CONTEXTMENU["ADD_JOINT"] = 15] = "ADD_JOINT";
        CONTEXTMENU[CONTEXTMENU["DELETE_RESOURCE"] = 16] = "DELETE_RESOURCE";
        CONTEXTMENU[CONTEXTMENU["CLONE_RESOURCE"] = 17] = "CLONE_RESOURCE";
        CONTEXTMENU[CONTEXTMENU["ORTHGRAPHIC_CAMERA"] = 18] = "ORTHGRAPHIC_CAMERA";
        CONTEXTMENU[CONTEXTMENU["RENDER_CONTINUOUSLY"] = 19] = "RENDER_CONTINUOUSLY";
        CONTEXTMENU[CONTEXTMENU["ADD_PROPERTY"] = 20] = "ADD_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["DELETE_PROPERTY"] = 21] = "DELETE_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["CONVERT_ANIMATION"] = 22] = "CONVERT_ANIMATION";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_PROPERTY"] = 23] = "ADD_PARTICLE_PROPERTY";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_FUNCTION"] = 24] = "ADD_PARTICLE_FUNCTION";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_CONSTANT"] = 25] = "ADD_PARTICLE_CONSTANT";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_CODE"] = 26] = "ADD_PARTICLE_CODE";
        CONTEXTMENU[CONTEXTMENU["ADD_PARTICLE_TRANSFORMATION"] = 27] = "ADD_PARTICLE_TRANSFORMATION";
        CONTEXTMENU[CONTEXTMENU["DELETE_PARTICLE_DATA"] = 28] = "DELETE_PARTICLE_DATA";
    })(CONTEXTMENU = Fudge.CONTEXTMENU || (Fudge.CONTEXTMENU = {}));
    let MENU;
    (function (MENU) {
        MENU["QUIT"] = "quit";
        MENU["PROJECT_NEW"] = "projectNew";
        MENU["PROJECT_SAVE"] = "projectSave";
        MENU["PROJECT_LOAD"] = "projectLoad";
        MENU["DEVTOOLS_OPEN"] = "devtoolsOpen";
        MENU["PANEL_GRAPH_OPEN"] = "panelGraphOpen";
        MENU["PANEL_ANIMATION_OPEN"] = "panelAnimationOpen";
        MENU["PANEL_PROJECT_OPEN"] = "panelProjectOpen";
        MENU["PANEL_HELP_OPEN"] = "panelHelpOpen";
        MENU["PANEL_PARTICLE_SYSTEM_OPEN"] = "panelParticleSystemOpen";
        MENU["FULLSCREEN"] = "fullscreen";
    })(MENU = Fudge.MENU || (Fudge.MENU = {}));
    let PANEL;
    (function (PANEL) {
        PANEL["GRAPH"] = "PanelGraph";
        PANEL["PROJECT"] = "PanelProject";
        PANEL["HELP"] = "PanelHelp";
        PANEL["ANIMATION"] = "PanelAnimation";
        PANEL["PARTICLE_SYSTEM"] = "PanelParticleSystem";
    })(PANEL = Fudge.PANEL || (Fudge.PANEL = {}));
    let VIEW;
    (function (VIEW) {
        VIEW["HIERARCHY"] = "ViewHierarchy";
        VIEW["ANIMATION"] = "ViewAnimation";
        VIEW["ANIMATION_SHEET"] = "ViewAnimationSheet";
        VIEW["RENDER"] = "ViewRender";
        VIEW["COMPONENTS"] = "ViewComponents";
        VIEW["CAMERA"] = "ViewCamera";
        VIEW["INTERNAL_TABLE"] = "ViewInternalTable";
        VIEW["INTERNAL_FOLDER"] = "ViewInternalFolder";
        VIEW["EXTERNAL"] = "ViewExternal";
        VIEW["PROPERTIES"] = "ViewProperties";
        VIEW["PREVIEW"] = "ViewPreview";
        VIEW["SCRIPT"] = "ViewScript";
        VIEW["PARTICLE_SYSTEM"] = "ViewParticleSystem";
        // SKETCH = ViewSketch,
        // MESH = ViewMesh,
    })(VIEW = Fudge.VIEW || (Fudge.VIEW = {}));
    let TRANSFORM;
    (function (TRANSFORM) {
        TRANSFORM["NONE"] = "none";
        TRANSFORM["TRANSLATE"] = "translate";
        TRANSFORM["ROTATE"] = "rotate";
        TRANSFORM["SCALE"] = "scale";
        TRANSFORM["WORLD"] = "world";
        TRANSFORM["LOCAL"] = "local";
    })(TRANSFORM = Fudge.TRANSFORM || (Fudge.TRANSFORM = {}));
})(Fudge || (Fudge = {}));
///<reference types="../../node_modules/electron"/>
/**
 * Main electron application running node. Starts the browser window to contain Fudge and sets up the main menu.
 * See subfolder Fudge for most of the other functionality
 */
var Main;
///<reference types="../../node_modules/electron"/>
/**
 * Main electron application running node. Starts the browser window to contain Fudge and sets up the main menu.
 * See subfolder Fudge for most of the other functionality
 */
(function (Main) {
    //#region Types and Data
    // eslint-disable-next-line @typescript-eslint/naming-convention
    const { app, BrowserWindow, Menu, ipcMain } = require("electron");
    const { join } = require("path");
    // couldn't find type in electron d.ts file
    const remote = require("@electron/remote/main");
    remote.initialize();
    let fudge;
    let defaultWidth = 800;
    let defaultHeight = 600;
    let saved = false;
    //#endregion
    // app.commandLine.appendSwitch("autoplay-policy", "no-user-gesture-required");
    //#region Events 
    app.addListener("ready", createFudge);
    app.addListener("activate", function () {
        console.log("Activate");
        if (fudge === null)
            createFudge();
    });
    ipcMain.addListener("enableMenuItem", function (_event, _args) {
        Menu.getApplicationMenu().getMenuItemById(_args["item"]).enabled = _args["on"];
    });
    function quit(_event) {
        if (!saved) {
            if ("type" in _event)
                console.log("Trying to save state!", _event.type);
            // _event.preventDefault();
            send(fudge, Fudge.MENU.QUIT);
            saved = true;
            if (process.platform !== "darwin")
                app.quit();
        }
    }
    function send(_window, _message, ..._args) {
        console.log(`Send message ${_message}`);
        _window.webContents.send(_message, _args);
    }
    //#endregion
    //#region Window
    function createFudge() {
        console.log("createFudge");
        fudge = addWindow("../Html/Fudge.html");
        const menu = Menu.buildFromTemplate(getMenuFudge());
        // fudge.setMenu(menu);
        Menu.setApplicationMenu(menu);
        fudge.on("close", quit);
    }
    function addWindow(_url, _width = defaultWidth, _height = defaultHeight) {
        let window = new BrowserWindow({
            width: _width,
            height: _height,
            icon: join(__dirname, "../Html/Image/Logo64.png"),
            // fullscreen: true,
            webPreferences: {
                nodeIntegration: true,
                contextIsolation: false
            }
        });
        remote.enable(window.webContents);
        window.webContents.openDevTools();
        window.loadFile(_url);
        window.maximize();
        return window;
    }
    // #endregion
    //#region Menus  
    function menuSelect(_item, _window, _event) {
        console.log(`MenuSelect: Item-id=${Fudge.MENU[_item.id]}`);
        // TODO: simplify switch using enums as messages
        switch (_item.id) {
            case Fudge.MENU.DEVTOOLS_OPEN:
                _window.webContents.openDevTools();
                break;
            case Fudge.MENU.FULLSCREEN:
                _window.fullScreen = !_window.isFullScreen();
                break;
            case Fudge.MENU.QUIT:
                quit({ type: "Ctrl+Q" });
                break;
            default:
                send(_window, _item.id, null);
                break;
        }
    }
    function getMenuFudge() {
        const menu = [
            {
                label: "Project", submenu: [
                    { label: "New", id: Fudge.MENU.PROJECT_NEW, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+N" : "Ctrl+N" },
                    { label: "Load", id: Fudge.MENU.PROJECT_LOAD, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+L" : "Ctrl+L" },
                    { label: "Save", id: Fudge.MENU.PROJECT_SAVE, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+S" : "Ctrl+S", enabled: false },
                    { label: "Quit", id: Fudge.MENU.QUIT, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+Q" : "Ctrl+Q" }
                ]
            },
            {
                label: "Panel", submenu: [
                    { label: "Help", id: Fudge.MENU.PANEL_HELP_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+H" : "Ctrl+H", enabled: true },
                    { label: "Project", id: Fudge.MENU.PANEL_PROJECT_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+R" : "Ctrl+R", enabled: false },
                    { label: "Graph", id: Fudge.MENU.PANEL_GRAPH_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+G" : "Ctrl+G", enabled: false },
                    { label: "Animation", id: Fudge.MENU.PANEL_ANIMATION_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "Command+I" : "Ctrl+I", enabled: false },
                    { label: "Particle System", id: Fudge.MENU.PANEL_PARTICLE_SYSTEM_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "" : "", enabled: false }
                ]
            },
            {
                label: "Debug", submenu: [
                    { label: "DevTool", id: Fudge.MENU.DEVTOOLS_OPEN, click: menuSelect, accelerator: process.platform == "darwin" ? "F12" : "F12" },
                    { label: "Fullscreen", id: Fudge.MENU.FULLSCREEN, click: menuSelect, accelerator: process.platform == "darwin" ? "F11" : "F11" }
                ]
            }
        ];
        return menu;
    }
    // #endregion
})(Main || (Main = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL1NvdXJjZS9GdWRnZS9EZWZpbml0aW9uLnRzIiwiLi4vU291cmNlL01haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsSUFBVSxLQUFLLENBb0ZkO0FBcEZELFdBQVUsS0FBSztJQUNiLElBQVksV0ErQlg7SUEvQkQsV0FBWSxXQUFXO1FBQ3JCLHVCQUF1QjtRQUN2QixxREFBUSxDQUFBO1FBQ1IsK0RBQWEsQ0FBQTtRQUNiLDJEQUFXLENBQUE7UUFDWCwrREFBYSxDQUFBO1FBQ2IscUVBQWdCLENBQUE7UUFDaEIsNkVBQW9CLENBQUE7UUFDcEIsNkNBQUksQ0FBQTtRQUNKLCtEQUFhLENBQUE7UUFDYiwyREFBVyxDQUFBO1FBQ1gsbUVBQWUsQ0FBQTtRQUNmLDhEQUFZLENBQUE7UUFDWixzRUFBZ0IsQ0FBQTtRQUNoQixrRkFBc0IsQ0FBQTtRQUN0QixrRUFBYyxDQUFBO1FBQ2Qsc0VBQWdCLENBQUE7UUFDaEIsd0RBQVMsQ0FBQTtRQUNULG9FQUFlLENBQUE7UUFDZixrRUFBYyxDQUFBO1FBQ2QsMEVBQWtCLENBQUE7UUFDbEIsNEVBQW1CLENBQUE7UUFDbkIsOERBQVksQ0FBQTtRQUNaLG9FQUFlLENBQUE7UUFDZix3RUFBaUIsQ0FBQTtRQUNqQixnRkFBcUIsQ0FBQTtRQUNyQixnRkFBcUIsQ0FBQTtRQUNyQixnRkFBcUIsQ0FBQTtRQUNyQix3RUFBaUIsQ0FBQTtRQUNqQiw0RkFBMkIsQ0FBQTtRQUMzQiw4RUFBb0IsQ0FBQTtJQUN0QixDQUFDLEVBL0JXLFdBQVcsR0FBWCxpQkFBVyxLQUFYLGlCQUFXLFFBK0J0QjtJQUdELElBQVksSUFZWDtJQVpELFdBQVksSUFBSTtRQUNkLHFCQUFhLENBQUE7UUFDYixrQ0FBMEIsQ0FBQTtRQUMxQixvQ0FBNEIsQ0FBQTtRQUM1QixvQ0FBNEIsQ0FBQTtRQUM1QixzQ0FBOEIsQ0FBQTtRQUM5QiwyQ0FBbUMsQ0FBQTtRQUNuQyxt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RSxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUU7aUJBQ2hLO2FBQ0Y7WUFDRDtnQkFDRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtvQkFDdkIsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxPQUFPLENBQUMsUUFBUSxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUU7b0JBQ2hJLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsT0FBTyxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFO2lCQUNqSTthQUNGO1NBQUMsQ0FBQztRQUNMLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUNELGFBQWE7QUFDZixDQUFDLEVBaElTLElBQUksS0FBSixJQUFJLFFBZ0liIiwic291cmNlc0NvbnRlbnQiOlsibmFtZXNwYWNlIEZ1ZGdlIHtcclxuICBleHBvcnQgZW51bSBDT05URVhUTUVOVSB7XHJcbiAgICAvLyBTS0VUQ0ggPSBWaWV3U2tldGNoLFxyXG4gICAgQUREX05PREUsXHJcbiAgICBBQ1RJVkFURV9OT0RFLFxyXG4gICAgREVMRVRFX05PREUsXHJcbiAgICBBRERfQ09NUE9ORU5ULFxyXG4gICAgREVMRVRFX0NPTVBPTkVOVCxcclxuICAgIEFERF9DT01QT05FTlRfU0NSSVBULFxyXG4gICAgRURJVCxcclxuICAgIENSRUFURV9GT0xERVIsXHJcbiAgICBDUkVBVEVfTUVTSCxcclxuICAgIENSRUFURV9NQVRFUklBTCxcclxuICAgIENSRUFURV9HUkFQSCxcclxuICAgIENSRUFURV9BTklNQVRJT04sXHJcbiAgICBDUkVBVEVfUEFSVElDTEVfRUZGRUNULFxyXG4gICAgU1lOQ19JTlNUQU5DRVMsXHJcbiAgICBSRU1PVkVfQ09NUE9ORU5ULFxyXG4gICAgQUREX0pPSU5ULFxyXG4gICAgREVMRVRFX1JFU09VUkNFLFxyXG4gICAgQ0xPTkVfUkVTT1VSQ0UsXHJcbiAgICBPUlRIR1JBUEhJQ19DQU1FUkEsXHJcbiAgICBSRU5ERVJfQ09OVElOVU9VU0xZLFxyXG4gICAgQUREX1BST1BFUlRZLFxyXG4gICAgREVMRVRFX1BST1BFUlRZLFxyXG4gICAgQ09OVkVSVF9BTklNQVRJT04sXHJcbiAgICBBRERfUEFSVElDTEVfUFJPUEVSVFksXHJcbiAgICBBRERfUEFSVElDTEVfRlVOQ1RJT04sXHJcbiAgICBBRERfUEFSVElDTEVfQ09OU1RBTlQsXHJcbiAgICBBRERfUEFSVElDTEVfQ09ERSxcclxuICAgIEFERF9QQVJUSUNMRV9UUkFOU0ZPUk1BVElPTixcclxuICAgIERFTEVURV9QQVJUSUNMRV9EQVRBXHJcbiAgfVxyXG5cclxuXHJcbiAgZXhwb3J0IGVudW0gTUVOVSB7XHJcbiAgICBRVUlUID0gXCJxdWl0XCIsXHJcbiAgICBQUk9KRUNUX05FVyA9IFwicHJvamVjdE5ld1wiLFxyXG4gICAgUFJPSkVDVF9TQVZFID0gXCJwcm9qZWN0U2F2ZVwiLFxyXG4gICAgUFJPSkVDVF9MT0FEID0gXCJwcm9qZWN0TG9hZFwiLFxyXG4gICAgREVWVE9PTFNfT1BFTiA9IFwiZGV2dG9vbHNPcGVuXCIsXHJcbiAgICBQQU5FTF9HUkFQSF9PUEVOID0gXCJwYW5lbEdyYXBoT3BlblwiLFxyXG4gICAgUEFORUxfQU5JTUFUSU9OX09QRU4gPSBcInBhbmVsQW5pbWF0aW9uT3BlblwiLFxyXG4gICAgUEFORUxfUFJPSkVDVF9PUEVOID0gXCJwYW5lbFByb2plY3RPcGVuXCIsXHJcbiAgICBQQU5FTF9IRUxQX09QRU4gPSBcInBhbmVsSGVscE9wZW5cIixcclxuICAgIFBBTkVMX1BBUlRJQ0xFX1NZU1RFTV9PUEVOID0gXCJwYW5lbFBhcnRpY2xlU3lzdGVtT3BlblwiLFxyXG4gICAgRlVMTFNDUkVFTiA9IFwiZnVsbHNjcmVlblwiXHJcbiAgfVxyXG5cclxuICBleHBvcnQgZW51bSBQQU5FTCB7XHJcbiAgICBHUkFQSCA9IFwiUGFuZWxHcmFwaFwiLFxyXG4gICAgUFJPSkVDVCA9IFwiUGFuZWxQcm9qZWN0XCIsXHJcbiAgICBIRUxQID0gXCJQYW5lbEhlbHBcIixcclxuICAgIEFOSU1BVElPTiA9IFwiUGFuZWxBbmltYXRpb25cIixcclxuICAgIFBBUlRJQ0xFX1NZU1RFTSA9IFwiUGFuZWxQYXJ0aWNsZVN5c3RlbVwiXHJcblxyXG4gIH1cclxuXHJcbiAgZXhwb3J0IGVudW0gVklFVyB7XHJcbiAgICBISUVSQVJDSFkgPSBcIlZpZXdIaWVyYXJjaHlcIixcclxuICAgIEFOSU1BVElPTiA9IFwiVmlld0FuaW1hdGlvblwiLFxyXG4gICAgQU5JTUFUSU9OX1NIRUVUID0gXCJWaWV3QW5pbWF0aW9uU2hlZXRcIixcclxuICAgIFJFTkRFUiA9IFwiVmlld1JlbmRlclwiLFxyXG4gICAgQ09NUE9ORU5UUyA9IFwiVmlld0NvbXBvbmVudHNcIixcclxuICAgIENBTUVSQSA9IFwiVmlld0NhbWVyYVwiLFxyXG4gICAgSU5URVJOQUxfVEFCTEUgPSBcIlZpZXdJbnRlcm5hbFRhYmxlXCIsXHJcbiAgICBJTlRFUk5BTF9GT0xERVIgPSBcIlZpZXdJbnRlcm5hbEZvbGRlclwiLFxyXG4gICAgRVhURVJOQUwgPSBcIlZpZXdFeHRlcm5hbFwiLFxyXG4gICAgUFJPUEVSVElFUyA9IFwiVmlld1Byb3BlcnRpZXNcIixcclxuICAgIFBSRVZJRVcgPSBcIlZpZXdQcmV2aWV3XCIsXHJcbiAgICBTQ1JJUFQgPSBcIlZpZXdTY3JpcHRcIixcclxuICAgIFBBUlRJQ0xFX1NZU1RFTSA9IFwiVmlld1BhcnRpY2xlU3lzdGVtXCJcclxuICAgIC8vIFNLRVRDSCA9IFZpZXdTa2V0Y2gsXHJcbiAgICAvLyBNRVNIID0gVmlld01lc2gsXHJcbiAgfVxyXG5cclxuICBleHBvcnQgZW51bSBUUkFOU0ZPUk0ge1xyXG4gICAgTk9ORSA9IFwibm9uZVwiLFxyXG4gICAgVFJBTlNMQVRFID0gXCJ0cmFuc2xhdGVcIixcclxuICAgIFJPVEFURSA9IFwicm90YXRlXCIsXHJcbiAgICBTQ0FMRSA9IFwic2NhbGVcIixcclxuICAgIFdPUkxEID0gXCJ3b3JsZFwiLFxyXG4gICAgTE9DQUwgPSBcImxvY2FsXCJcclxuICB9XHJcbn0iLCIvLy88cmVmZXJlbmNlIHR5cGVzPVwiLi4vLi4vbm9kZV9tb2R1bGVzL2VsZWN0cm9uXCIvPlxyXG5cclxuLyoqXHJcbiAqIE1haW4gZWxlY3Ryb24gYXBwbGljYXRpb24gcnVubmluZyBub2RlLiBTdGFydHMgdGhlIGJyb3dzZXIgd2luZG93IHRvIGNvbnRhaW4gRnVkZ2UgYW5kIHNldHMgdXAgdGhlIG1haW4gbWVudS5cclxuICogU2VlIHN1YmZvbGRlciBGdWRnZSBmb3IgbW9zdCBvZiB0aGUgb3RoZXIgZnVuY3Rpb25hbGl0eVxyXG4gKi9cclxubmFtZXNwYWNlIE1haW4ge1xyXG4gIC8vI3JlZ2lvbiBUeXBlcyBhbmQgRGF0YVxyXG5cclxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uXHJcbiAgY29uc3QgeyBhcHAsIEJyb3dzZXJXaW5kb3csIE1lbnUsIGlwY01haW4gfSA9IHJlcXVpcmUoXCJlbGVjdHJvblwiKTtcclxuICBjb25zdCB7IGpvaW4gfSA9IDx0eXBlb2YgaW1wb3J0KFwicGF0aFwiKT5yZXF1aXJlKFwicGF0aFwiKTtcclxuXHJcbiAgLy8gY291bGRuJ3QgZmluZCB0eXBlIGluIGVsZWN0cm9uIGQudHMgZmlsZVxyXG4gIGNvbnN0IHJlbW90ZTogeyBpbml0aWFsaXplOiAoKSA9PiB2b2lkOyBlbmFibGU6IChjb250ZW50czogRWxlY3Ryb24uV2ViQ29udGVudHMpID0+IHZvaWQgfSA9IHJlcXVpcmUoXCJAZWxlY3Ryb24vcmVtb3RlL21haW5cIik7XHJcblxyXG4gIHJlbW90ZS5pbml0aWFsaXplKCk7XHJcblxyXG4gIGxldCBmdWRnZTogRWxlY3Ryb24uQnJvd3NlcldpbmRvdztcclxuICBsZXQgZGVmYXVsdFdpZHRoOiBudW1iZXIgPSA4MDA7XHJcbiAgbGV0IGRlZmF1bHRIZWlnaHQ6IG51bWJlciA9IDYwMDtcclxuICBsZXQgc2F2ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAvLyNlbmRyZWdpb25cclxuXHJcbiAgLy8gYXBwLmNvbW1hbmRMaW5lLmFwcGVuZFN3aXRjaChcImF1dG9wbGF5LXBvbGljeVwiLCBcIm5vLXVzZXItZ2VzdHVyZS1yZXF1aXJlZFwiKTtcclxuXHJcbiAgLy8jcmVnaW9uIEV2ZW50cyBcclxuICBhcHAuYWRkTGlzdGVuZXIoXCJyZWFkeVwiLCBjcmVhdGVGdWRnZSk7XHJcbiAgYXBwLmFkZExpc3RlbmVyKFwiYWN0aXZhdGVcIiwgZnVuY3Rpb24gKCk6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coXCJBY3RpdmF0ZVwiKTtcclxuICAgIGlmIChmdWRnZSA9PT0gbnVsbCkgY3JlYXRlRnVkZ2UoKTtcclxuICB9KTtcclxuXHJcbiAgaXBjTWFpbi5hZGRMaXN0ZW5lcihcImVuYWJsZU1lbnVJdGVtXCIsIGZ1bmN0aW9uIChfZXZlbnQ6IEVsZWN0cm9uLkV2ZW50LCBfYXJnczogT2JqZWN0KTogdm9pZCB7XHJcbiAgICBNZW51LmdldEFwcGxpY2F0aW9uTWVudSgpLmdldE1lbnVJdGVtQnlJZChfYXJnc1tcIml0ZW1cIl0pLmVuYWJsZWQgPSBfYXJnc1tcIm9uXCJdO1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBxdWl0KF9ldmVudDogRWxlY3Ryb24uRXZlbnQgfCB7IHR5cGU6IHN0cmluZyB9KTogdm9pZCB7XHJcbiAgICBpZiAoIXNhdmVkKSB7XHJcbiAgICAgIGlmIChcInR5cGVcIiBpbiBfZXZlbnQpXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJUcnlpbmcgdG8gc2F2ZSBzdGF0ZSFcIiwgX2V2ZW50LnR5cGUpO1xyXG4gICAgICAvLyBfZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgc2VuZChmdWRnZSwgRnVkZ2UuTUVOVS5RVUlUKTtcclxuICAgICAgc2F2ZWQgPSB0cnVlO1xyXG4gICAgICBpZiAocHJvY2Vzcy5wbGF0Zm9ybSAhPT0gXCJkYXJ3aW5cIilcclxuICAgICAgICBhcHAucXVpdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2VuZChfd2luZG93OiBFbGVjdHJvbi5Ccm93c2VyV2luZG93LCBfbWVzc2FnZTogc3RyaW5nLCAuLi5fYXJnczogdW5rbm93bltdKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZyhgU2VuZCBtZXNzYWdlICR7X21lc3NhZ2V9YCk7XHJcbiAgICBfd2luZG93LndlYkNvbnRlbnRzLnNlbmQoX21lc3NhZ2UsIF9hcmdzKTtcclxuICB9XHJcbiAgLy8jZW5kcmVnaW9uXHJcblxyXG4gIC8vI3JlZ2lvbiBXaW5kb3dcclxuICBmdW5jdGlvbiBjcmVhdGVGdWRnZSgpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKFwiY3JlYXRlRnVkZ2VcIik7XHJcbiAgICBmdWRnZSA9IGFkZFdpbmRvdyhcIi4uL0h0bWwvRnVkZ2UuaHRtbFwiKTtcclxuICAgIGNvbnN0IG1lbnU6IEVsZWN0cm9uLk1lbnUgPSBNZW51LmJ1aWxkRnJvbVRlbXBsYXRlKGdldE1lbnVGdWRnZSgpKTtcclxuICAgIC8vIGZ1ZGdlLnNldE1lbnUobWVudSk7XHJcbiAgICBNZW51LnNldEFwcGxpY2F0aW9uTWVudShtZW51KTtcclxuICAgIGZ1ZGdlLm9uKFwiY2xvc2VcIiwgcXVpdCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGRXaW5kb3coX3VybDogc3RyaW5nLCBfd2lkdGg6IG51bWJlciA9IGRlZmF1bHRXaWR0aCwgX2hlaWdodDogbnVtYmVyID0gZGVmYXVsdEhlaWdodCk6IEVsZWN0cm9uLkJyb3dzZXJXaW5kb3cge1xyXG4gICAgbGV0IHdpbmRvdzogRWxlY3Ryb24uQnJvd3NlcldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcclxuICAgICAgd2lkdGg6IF93aWR0aCxcclxuICAgICAgaGVpZ2h0OiBfaGVpZ2h0LFxyXG4gICAgICBpY29uOiBqb2luKF9fZGlybmFtZSwgXCIuLi9IdG1sL0ltYWdlL0xvZ282NC5wbmdcIiksXHJcbiAgICAgIC8vIGZ1bGxzY3JlZW46IHRydWUsXHJcbiAgICAgIHdlYlByZWZlcmVuY2VzOiB7ICAgICAgICAvLyBwcmVsb2FkOiBwYXRoLmpvaW4oX19kaXJuYW1lLCBcInByZWxvYWQuanNcIiksXHJcbiAgICAgICAgbm9kZUludGVncmF0aW9uOiB0cnVlLFxyXG4gICAgICAgIGNvbnRleHRJc29sYXRpb246IGZhbHNlXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHJlbW90ZS5lbmFibGUod2luZG93LndlYkNvbnRlbnRzKTtcclxuXHJcbiAgICB3aW5kb3cud2ViQ29udGVudHMub3BlbkRldlRvb2xzKCk7XHJcbiAgICB3aW5kb3cubG9hZEZpbGUoX3VybCk7XHJcbiAgICB3aW5kb3cubWF4aW1pemUoKTtcclxuICAgIHJldHVybiB3aW5kb3c7XHJcbiAgfVxyXG4gIC8vICNlbmRyZWdpb25cclxuXHJcbiAgLy8jcmVnaW9uIE1lbnVzICBcclxuICBmdW5jdGlvbiBtZW51U2VsZWN0KF9pdGVtOiBFbGVjdHJvbi5NZW51SXRlbSwgX3dpbmRvdzogRWxlY3Ryb24uQnJvd3NlcldpbmRvdywgX2V2ZW50OiBFbGVjdHJvbi5LZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZyhgTWVudVNlbGVjdDogSXRlbS1pZD0ke0Z1ZGdlLk1FTlVbX2l0ZW0uaWRdfWApO1xyXG4gICAgLy8gVE9ETzogc2ltcGxpZnkgc3dpdGNoIHVzaW5nIGVudW1zIGFzIG1lc3NhZ2VzXHJcbiAgICBzd2l0Y2ggKF9pdGVtLmlkKSB7XHJcbiAgICAgIGNhc2UgRnVkZ2UuTUVOVS5ERVZUT09MU19PUEVOOlxyXG4gICAgICAgIF93aW5kb3cud2ViQ29udGVudHMub3BlbkRldlRvb2xzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgRnVkZ2UuTUVOVS5GVUxMU0NSRUVOOlxyXG4gICAgICAgIF93aW5kb3cuZnVsbFNjcmVlbiA9ICFfd2luZG93LmlzRnVsbFNjcmVlbigpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIEZ1ZGdlLk1FTlUuUVVJVDpcclxuICAgICAgICBxdWl0KHsgdHlwZTogXCJDdHJsK1FcIiB9KTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICBzZW5kKF93aW5kb3csIF9pdGVtLmlkLCBudWxsKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldE1lbnVGdWRnZSgpOiBFbGVjdHJvbi5NZW51SXRlbUNvbnN0cnVjdG9yT3B0aW9uc1tdIHtcclxuICAgIGNvbnN0IG1lbnU6IEVsZWN0cm9uLk1lbnVJdGVtQ29uc3RydWN0b3JPcHRpb25zW10gPSBbXHJcbiAgICAgIHtcclxuICAgICAgICBsYWJlbDogXCJQcm9qZWN0XCIsIHN1Ym1lbnU6IFtcclxuICAgICAgICAgIHsgbGFiZWw6IFwiTmV3XCIsIGlkOiBGdWRnZS5NRU5VLlBST0pFQ1RfTkVXLCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiQ29tbWFuZCtOXCIgOiBcIkN0cmwrTlwiIH0sXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIkxvYWRcIiwgaWQ6IEZ1ZGdlLk1FTlUuUFJPSkVDVF9MT0FELCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiQ29tbWFuZCtMXCIgOiBcIkN0cmwrTFwiIH0sXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIlNhdmVcIiwgaWQ6IEZ1ZGdlLk1FTlUuUFJPSkVDVF9TQVZFLCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiQ29tbWFuZCtTXCIgOiBcIkN0cmwrU1wiLCBlbmFibGVkOiBmYWxzZSB9LFxyXG4gICAgICAgICAgeyBsYWJlbDogXCJRdWl0XCIsIGlkOiBGdWRnZS5NRU5VLlFVSVQsIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK1FcIiA6IFwiQ3RybCtRXCIgfVxyXG4gICAgICAgIF1cclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGxhYmVsOiBcIlBhbmVsXCIsIHN1Ym1lbnU6IFtcclxuICAgICAgICAgIHsgbGFiZWw6IFwiSGVscFwiLCBpZDogRnVkZ2UuTUVOVS5QQU5FTF9IRUxQX09QRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK0hcIiA6IFwiQ3RybCtIXCIsIGVuYWJsZWQ6IHRydWUgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiUHJvamVjdFwiLCBpZDogRnVkZ2UuTUVOVS5QQU5FTF9QUk9KRUNUX09QRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK1JcIiA6IFwiQ3RybCtSXCIsIGVuYWJsZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIkdyYXBoXCIsIGlkOiBGdWRnZS5NRU5VLlBBTkVMX0dSQVBIX09QRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJDb21tYW5kK0dcIiA6IFwiQ3RybCtHXCIsIGVuYWJsZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgICB7IGxhYmVsOiBcIkFuaW1hdGlvblwiLCBpZDogRnVkZ2UuTUVOVS5QQU5FTF9BTklNQVRJT05fT1BFTiwgY2xpY2s6IG1lbnVTZWxlY3QsIGFjY2VsZXJhdG9yOiBwcm9jZXNzLnBsYXRmb3JtID09IFwiZGFyd2luXCIgPyBcIkNvbW1hbmQrSVwiIDogXCJDdHJsK0lcIiwgZW5hYmxlZDogZmFsc2UgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiUGFydGljbGUgU3lzdGVtXCIsIGlkOiBGdWRnZS5NRU5VLlBBTkVMX1BBUlRJQ0xFX1NZU1RFTV9PUEVOLCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiXCIgOiBcIlwiLCBlbmFibGVkOiBmYWxzZSB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgbGFiZWw6IFwiRGVidWdcIiwgc3VibWVudTogW1xyXG4gICAgICAgICAgeyBsYWJlbDogXCJEZXZUb29sXCIsIGlkOiBGdWRnZS5NRU5VLkRFVlRPT0xTX09QRU4sIGNsaWNrOiBtZW51U2VsZWN0LCBhY2NlbGVyYXRvcjogcHJvY2Vzcy5wbGF0Zm9ybSA9PSBcImRhcndpblwiID8gXCJGMTJcIiA6IFwiRjEyXCIgfSxcclxuICAgICAgICAgIHsgbGFiZWw6IFwiRnVsbHNjcmVlblwiLCBpZDogRnVkZ2UuTUVOVS5GVUxMU0NSRUVOLCBjbGljazogbWVudVNlbGVjdCwgYWNjZWxlcmF0b3I6IHByb2Nlc3MucGxhdGZvcm0gPT0gXCJkYXJ3aW5cIiA/IFwiRjExXCIgOiBcIkYxMVwiIH1cclxuICAgICAgICBdXHJcbiAgICAgIH1dO1xyXG4gICAgcmV0dXJuIG1lbnU7XHJcbiAgfVxyXG4gIC8vICNlbmRyZWdpb25cclxufVxyXG4iXX0=